<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>detail</title>
    <link rel="stylesheet" href="https://mofom.net/style.css" />
	<link rel="shortcut icon" href="https://mofom.net/logo_20251021.ico" type="image/x-icon" />
    <style>
		#detailContainer {
		    display: flex;
		    flex-direction: column;
		    max-width: calc(0.75 * 100vw);
		    margin: 20px auto;
		    padding: 15px;
		    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
		    background-color: #fff;
		    border-radius: 8px;
		    font-family: "Segoe UI", "Helvetica Neue", sans-serif;
		    color: #333;
		    width: 90%;
		    box-sizing: border-box;
		}
		
		#title {
		    font-size: 2.5rem;
		    margin-bottom: 8px;
		    color: #222;
		    line-height: 1.3;
		    word-wrap: break-word;
		}
		
		#discount.highlight {
		    font-size: 2.2rem;
		    color: #FFF;
			background-color: #e63946;
		    margin: 8px 0;
			padding: 0 8px;
		}
		
		#description {
		    font-size: 1.5rem;
		    line-height: 1.5;
		    padding: 0 5px;
		    text-align: justify;
		    word-wrap: break-word;
		}
		
		.gallery {
		    max-width: 100%;
		    height: auto;
		    margin: auto;
		}
		
		.main-image {
		    width: 100%;
		    height: auto;
		    max-height: 300px;
		    object-fit: cover;
		    border: 1px solid #444;
		    margin-bottom: 10px;
		    border-radius: 6px;
		}
		
		.thumbnails {
		    display: flex;
		    gap: 8px;
		    overflow-x: auto;
		    padding-bottom: 5px;
		    -webkit-overflow-scrolling: touch;
		}
		
		.thumbnails img {
		    width: 80px;
		    height: 60px;
		    object-fit: cover;
		    cursor: pointer;
		    border: 1px solid transparent;
		    transition: border 0.3s;
		    border-radius: 4px;
		    flex-shrink: 0;
		    -webkit-tap-highlight-color: transparent;
		}
		
		.thumbnails img:hover {
		    border: 1px solid #00aaff;
		}
		
		.errorDisplay {
			background-color: #e63946;
			color: #FFF;
			padding: 0 8px;
		}
		
		/* 响应式断点 - 与导航栏保持一致 */
		@media screen and (max-width: 768px) {
		    #detailContainer {
		        margin: 15px auto;
		        padding: 12px;
				max-width: 100vw;
		        width: 95%;
		    }
		    
		    #title {
		        font-size: 1.8rem;
		    }
		    
		    #discount.highlight {
		        font-size: 1.1rem;
		    }
		    
		    #description {
		        font-size: 0.9rem;
		        line-height: 1.4;
		        padding: 0;
		    }
		    
		    .main-image {
		        max-height: 250px;
		        margin-bottom: 8px;
		    }
		    
		    .thumbnails img {
		        width: 70px;
		        height: 50px;
		    }
		}
		
		/* 针对小屏幕手机的额外优化 */
		@media screen and (max-width: 480px) {
		    #detailContainer {
		        margin: 10px auto;
		        padding: 10px;
		        width: 98%;
		    }
		    
		    #title {
		        font-size: 2.2rem;
		    }
		    
		    #discount.highlight {
		        font-size: 1.5rem;
		    }
		    
		    #description {
		        font-size: 1rem;
		        line-height: 1.4;
		    }
		    
		    .main-image {
		        max-height: 200px;
		    }
		    
		    .thumbnails img {
		        width: 60px;
		        height: 45px;
		    }
		}

	</style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <a href="https://mofom.net">MOFOM INC</a>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="../index.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item">
                    <a href="index.html" class="nav-link active">Product</a>
                </li>
                <li class="nav-item">
                    <a href="../help.html" class="nav-link">Help</a>
                </li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>
    <div id="detailContainer_main">
		<div id="detailContainer">
		  <h1 id="title"></h1>
		
		  <div class="gallery">
		    <img id="mainImage" class="main-image" src="" alt="img_main">
		    <div class="thumbnails" id="imageList"></div>
		  </div>
		
		  <h2 id="discount" class="highlight"></h2>
		  <p id="description"></p>
		</div>
		
		
		

    </div>
	<footer class="footer">
	    <div class="container">
	        <div class="footer-content">
	            <div class="footer-section">
	                <h3>MOFOM Inc, CA, USA</h3>
	                <p></p>
	            </div>
	            <div class="footer-section">
	                <h4>contact us</h4>
	                
					
	                <p>EMAIL: info@mofom.net</p>
	            </div>
	            <!-- <div class="footer-section">
	                <h4>View our other products</h4>
	                <div class="social-links">
	                    <a href="http://www.shenghua.com.cn/">北京市升华电梯集团</a>
	                </div>
	            </div> -->
	        </div>
	        <div class="footer-bottom">
	            <p>Copyright&copy; 2025 MOFOM Inc. all rights reserved.</p>
				
	        </div>
	    </div>
	</footer>
    <script src="../script.js"></script>
    <script>
		const urlParams = new URLSearchParams(window.location.search);
		
		let itemId = parseInt(urlParams.get('id'), 10);
		let errinfo = '';
		
		async function loadData(itemId) {
		    const baseUrl = './productData';
		    let fileList = [];
			
			if(isNaN(itemId)) {
				console.warn("no itemId")
				return null;
			}
		
		    try {
		        const mainResponse = await fetch(`${baseUrl}/main.json`);
		        if (!mainResponse.ok) {
		            throw new Error(`connot load main.json: HTTP ${mainResponse.status}`);
		        }
		
		        const mainData = await mainResponse.json();
		        fileList = mainData.files || [];
		
		        if (fileList.length === 0) {
		            throw new Error('main.json does not have a list in it');
		        }
		
		        if (itemId < 0 || itemId >= fileList.length) {
		            throw new Error(`itemId too large: ${itemId}`);
		        }
		
		        const targetFile = fileList[itemId];
		        console.log(`it gonna load: ${targetFile}`);
		
		        const fileResponse = await fetch(`${baseUrl}/${targetFile}`);
		        if (!fileResponse.ok) {
		            throw new Error(`cannot load ${targetFile}: HTTP ${fileResponse.status}`);
		        }
		
		        const fileData = await fileResponse.json();
		
		        return fileData;
		
		    } catch (error) {
		        console.error('failed, in a word your data is missing:', error);
				errinfo = error.message;
		        return null;
		    }
		}
		async function renderData() {
			const content = await loadData(itemId);
			
			const imageList = document.getElementById("imageList");
			const content_container = document.getElementById('detailContainer');
			const title = document.getElementById("title");
			const description = document.getElementById("description");
			const discountInfo = document.getElementById("discount");
			
			if(content === null) {
				content_container.innerHTML = `
					<h1 class="errorDisplay">
					ERROR! 
					<br />
					CAN'T LOAD THE PAGE WITH ITEMID: ${itemId}
					<br />
					<br />
					${errinfo}
					</h1>
				`;
				return
			}
			
			
			// 加载图片
			var images = "";
			
			if(content.imagesUrl[0] == undefined) {
				content.imagesUrl[0] = "https://mofom.net/images/default/defaultText_sorry_no_image.png";
				console.log(content);
			}
			for(let i = 0; i < content.imagesUrl.length; i++) {
				images += `
					<img src="${content.imagesUrl[i]}" onclick="changeImage(this.src)">
				`;
			}
			document.getElementById('mainImage').src = content.imagesUrl[0];
			// console.log(images);
			imageList.innerHTML = images;
			
			//加载其他文字内容
			title.textContent = content.title;
			document.title = content.title;
			description.textContent = content.description;
			discountInfo.style.display = (content.discount.isDiscount === 0 ? "none" : "");
			let discountItem = content.discount;
			let discountMsg = "DISCOUNT_MESSAGE_ERROR";
			if(discountItem.discountTitle == undefined || discountItem.discountTitle == '') {
				discountMsg = `${content.discount.rate}% Off until ${content.discount.until}`;
			} else {
				discountMsg = `${discountItem.discountTitle}`;
			};
			
			discountInfo.textContent = `${discountMsg}`;
		}
		function changeImage(src) {
		    document.getElementById('mainImage').src = src;
		}

		document.addEventListener("DOMContentLoaded", renderData);
	</script>
</body>
</html>
